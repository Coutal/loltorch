#!/bin/bash
declare -a tiers=('challenger' 'master')
declare -a regions=('oce' 'eune' 'br' 'euw' 'kr' 'lan' 'las' 'na' 'tr' 'ru')
for tier in "${tiers[@]}"
do
    for region in "${regions[@]}"
    do
        mkdir -p "matches/""${region}"
        th getmatches.lua -region "${region}" -outdir matches -tier "${tier}" &
    done

    for job in `jobs -p`
    do
        wait $job
    done
done


trap 'kill $(jobs -p)' EXIT
